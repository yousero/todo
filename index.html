<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>todo</title>
  <style>
    * {
      box-sizing: border-box;
    }

    html,
    body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
    }

    body {
      font-family: sans-serif;
      font-size: 1em;
      line-height: 1;
      letter-spacing: 0.2px;
    }

    h1,
    h2,
    h3,
    h4,
    h5 {
      letter-spacing: 0.4px;
    }

    a {
      text-decoration: none;
      color: dodgerblue;
    }

    a:hover {
      text-decoration: none;
      color: deepskyblue;
    }

    template {
      display: none;
    }

    main {
      margin-top: 120px;
    }

    .container {
      display: flex;
      max-width: 720px;
      margin: auto;
      flex-direction: column;
    }

    #enter-task {
      font-size: 40px;
      width: 100%;
      border: 2px solid;
    }

    #task-name {}

    #task-list {
      margin-top: 20px;
    }

    .task {
      margin: 6px;
      font-size: 24px;
    }

    .removed-task {
      text-decoration: line-through;
    }
  </style>
</head>

<body>
  <main>
    <div class="container">
      <div class="task-name">
        <input type="text" id="enter-task" placeholder="Enter your task" />
      </div>
      <div id="task-list">
      </div>
    </div>
  </main>

  <script>
    const enterTask = document.querySelector('#enter-task')
    const taskList = document.querySelector('#task-list')

    const refresh = function () {
      const list = []
      const currentTasks = taskList.querySelectorAll('.task')
      for (const task of currentTasks) {
        if (!task.classList.contains('removed-task')) {
          list.push(task.textContent)
        }
      }
      localStorage.setItem('tasks', JSON.stringify(list))
    }

    const createTaskElement = function (value) {
      const elem = document.createElement('div')
      elem.className = 'task'
      elem.textContent = value
      elem.onclick = function (e) {
        elem.classList.toggle('removed-task')
        refresh()
      }
      return elem
    }

    const addTask = function (valueOrEvent) {
      const value = typeof valueOrEvent === 'string' ? valueOrEvent : valueOrEvent?.target?.value
      const trimmedValue = (value || '').trim()
      if (trimmedValue === '') {
        if (valueOrEvent?.target) {
          valueOrEvent.target.value = ''
        }
        return
      }
      const elem = createTaskElement(trimmedValue)
      taskList.appendChild(elem)
      refresh()
      if (valueOrEvent?.target) {
        valueOrEvent.target.value = ''
        valueOrEvent.target.focus()
      }
    }

    enterTask.addEventListener('keydown', function (e) {
      if (e.key === 'Enter') {
        e.preventDefault()
        addTask(e)
      }
    })

    enterTask.addEventListener('change', addTask)

    const list = JSON.parse(localStorage.getItem('tasks')) || []

    for (const task of list) {
      addTask(task)
    }
  </script>
</body>

</html>